<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vairal Video App</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { background: #0f0f0f; color: white; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 10px; }
        .container { display: flex; flex-wrap: wrap; justify-content: center; }
        .video-card { background: #1a1a1a; border-radius: 12px; margin: 10px; width: 90%; max-width: 350px; overflow: hidden; border: 1px solid #333; }
        .thumb { width: 100%; height: 180px; object-fit: cover; background: #222; }
        .info { padding: 15px; text-align: left; }
        .info h3 { margin: 0 0 10px 0; font-size: 16px; color: #fff; }
        .btn { background: #721c24; color: #f8d7da; border: none; padding: 12px; width: 100%; border-radius: 8px; font-weight: bold; cursor: pointer; display: block; text-decoration: none; text-align: center; font-size: 14px; }
        
        /* Ad Overlay */
        #ad-view { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 10000; flex-direction: column; justify-content: center; align-items: center; }
        .timer-circle { width: 80px; height: 80px; border: 4px solid #f00; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 30px; margin-bottom: 20px; }
        .ad-btn { background: #0088cc; color: white; padding: 15px 30px; border-radius: 30px; text-decoration: none; font-weight: bold; }
    </style>
</head>
<body>

    <div class="container" id="video-list">‡¶≤‡ßã‡¶°‡¶ø‡¶Ç...</div>

    <div id="ad-view">
        <div class="timer-circle" id="timer">10</div>
        <p id="ad-msg">‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
        <a href="#" id="main-ad-btn" class="ad-btn" style="display:none;" target="_blank">‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶®‡¶ü‡¶ø ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</a>
    </div>

    <script>
        const firebaseConfig = { databaseURL: "https://myvideobot-9f9ee-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
        db.ref('videos').on('value', (snapshot) => {
            const data = snapshot.val();
            const listArea = document.getElementById('video-list');
            listArea.innerHTML = "";
            for (let key in data) {
                listArea.innerHTML += `
                    <div class="video-card">
                        <img src="${data[key].photo}" class="thumb" onerror="this.src='https://via.placeholder.com/350x180?text=No+Image'">
                        <div class="info">
                            <h3>${data[key].name}</h3>
                            <button class="btn" onclick="startAdProcess('${key}', ${JSON.stringify(data[key].ads)})">üîì UNLOCK VIDEO</button>
                        </div>
                    </div>`;
            }
        });

        let adsArray = [];
        let currentKey = "";
        let adStep = 0;

        function startAdProcess(key, ads) {
            currentKey = key;
            adsArray = ads;
            adStep = 0;
            showNextAd();
        }

        function showNextAd() {
            const adOverlay = document.getElementById('ad-view');
            const timerText = document.getElementById('timer');
            const adBtn = document.getElementById('main-ad-btn');
            const msg = document.getElementById('ad-msg');

            adOverlay.style.display = 'flex';
            adBtn.style.display = 'none';
            msg.innerText = `‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ${adStep + 1} ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...`;

            let timeLeft = 10;
            const counter = setInterval(() => {
                timerText.innerText = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(counter);
                    msg.innerText = "‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶®‡¶ü‡¶ø ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®";
                    adBtn.style.display = 'block';
                    adBtn.href = adsArray[adStep];
                    
                    adBtn.onclick = () => {
                        adStep++;
                        if (adStep < adsArray.length) {
                            setTimeout(showNextAd, 2000); // ‡ß® ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶™‡¶∞ ‡¶™‡¶∞‡ßá‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°
                        } else {
                            msg.innerText = "‡¶∏‡¶¨ ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®! ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶Ü‡¶®‡¶≤‡¶ï ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
                            setTimeout(() => {
                                window.location.href = `https://t.me/vairal_video18_bot?start=${currentKey}`;
                            }, 2000);
                        }
                    };
                }
                timeLeft--;
            }, 1000);
        }
    </script>
</body>
</html>
